<!DOCTYPE html>
<html lang=" en-US">

<head>

    
    <meta charset="UTF-8"><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- Include tocNAV javascript -->
    <script type="text/javascript" src="../assets/js/tocNav.js"></script>

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Security | Computer Science Revision Guides</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Security" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hashing algorithms" />
<meta property="og:description" content="Hashing algorithms" />
<link rel="canonical" href="https://github.com/pages/CSRG-Group/dcs-notes.github.io/CS139/Theory6.html" />
<meta property="og:url" content="https://github.com/pages/CSRG-Group/dcs-notes.github.io/CS139/Theory6.html" />
<meta property="og:site_name" content="Computer Science Revision Guides" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-12T14:53:39+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Security" />
<script type="application/ld+json">
{"description":"Hashing algorithms","headline":"Security","dateModified":"2021-05-12T14:53:39+00:00","datePublished":"2021-05-12T14:53:39+00:00","url":"https://github.com/pages/CSRG-Group/dcs-notes.github.io/CS139/Theory6.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/pages/CSRG-Group/dcs-notes.github.io/CS139/Theory6.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style"
        type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/pages/CSRG-Group/dcs-notes.github.io/assets/css/style.css?v=c7cba74afde9610b1e7114060896a196d092ead3">
</head>

<body>
    <header style="padding:10px;" class="page-header" role="banner">
        <h1 class="project-name">Security</h1>
    </header>
    <div id="mainGrid" class="container">
        <div class="navBox">
            <div id="sidenav" class="sideNav closedNav">
                <h2 style="margin-left: 10px;">Table of Contents</h2><ul><li><a href="#hashing-algorithms">Hashing algorithms</a><ul><li><a href="#salt">Salt</a></li></ul></li><li><a href="#redirect">Redirect</a></li><li><a href="#query-stings">Query Stings</a></li><li><a href="#https">HTTPS</a><ul><li><a href="#operation">Operation</a><ul><li><a href="#public-key">Public Key</a></li><li><a href="#certificate-authority">Certificate authority</a></li></ul></li><li><a href="#drawbacks">drawbacks</a></li><li><a href="#man-in-the-middle">Man in the middle</a></li></ul></li><li><a href="#sql-injection">SQL injection</a><ul><li><a href="#prevention">Prevention</a></li></ul></li><li><a href="#session-sniffing">Session Sniffing</a></li><li><a href="#session-fixation">Session Fixation</a></li><li><a href="#xss">XSS</a><ul><li><a href="#persistent-xss">Persistent-XSS</a></li></ul></li><li><a href="#directory-traversal">Directory traversal</a></li><li><a href="#php-cgi-vulnerabilites">PHP-CGI vulnerabilites</a><ul><li><a href="#other-configuration-advice">other configuration advice</a></li></ul></li></ul>
</div>
        </div>
        <div title="Table of Contents" class="buttonCol" onclick="toggleNav()">
            <div class="navArrow">
                <i></i>
            </div>
        </div>
        <div class="contents">
            <main id="content" class="main-content" role="main">
                <div class="partNav"><a href="/CS139/Theory5.html" title="">üëàPrev</a><a href="./" title="CS139 Home">üè°CS139</a></div>
                <!-- Main Content of markdown or sub-layouts-->
                <!-- Each module has its own layout to allow module layouts to be customised -->
<!-- The layout name is also used by the notes layout to display the correct module code -->

<h1 id="hashing-algorithms">Hashing algorithms</h1>

<ul>
  <li>md5 - easily calculated but clashes have been found</li>
  <li>sha1 - (160 bits) easily calculated</li>
  <li>Bcrypt - current best recommendation</li>
</ul>

<p>Passwords are still susceptible to dictionary attacks</p>

<p>Passwords should be unique when stored</p>

<h2 id="salt">Salt</h2>
<p>a salt is a random value for each user and is included when checking the password. Can be stored alongside the password in the database.</p>

<ul>
  <li>11:11:23 + ‚ÄúPassword‚Äù =&gt; asdfkjh67fasf69d8f6aadf4w8‚Ä¶..</li>
  <li>22:21:23 + ‚ÄúPassword‚Äù =&gt; flkafj948rj9fjsd9cnyrur94jrf‚Ä¶.</li>
</ul>

<p>harder to crack many passwords
only needed for SHA1 php <code class="language-plaintext highlighter-rouge">password_hash</code> adds salt automatically</p>

<h1 id="redirect">Redirect</h1>
<p>When submitting a from the page should redirect to a confirmation page to prevent re entry , and prevent re-submit through refreshing the page. causing a double submit.</p>

<h1 id="query-stings">Query Stings</h1>
<p>Query stings can be modified by the user
query strings should be checked for validity nothing should be assumed</p>

<p>known as sanitizing / validating input</p>

<h1 id="https">HTTPS</h1>

<p>Https is a protocol for secure communication over a network, built on the SSL/TLS protocol.</p>

<p>the HTTP is encrypted but is not changed.</p>

<p>HTTPS should be used for all sensitive data.</p>

<p>Now all services opt for HTTPS and HTTP is rarely used.</p>

<h2 id="operation">Operation</h2>

<ol>
  <li>The client sends a list specifications to the server
    <ul>
      <li>what SSL/TLS version it is running</li>
      <li>What ciphersuits it wants to use</li>
      <li>What compression methods it wants to use</li>
    </ul>
  </li>
  <li>The server selects the highest SSL/TLS version and agrees on ciphersuits and compression</li>
  <li>The server sends a certificate to the client which must
    <ul>
      <li>be trusted by the client explicitly</li>
      <li>be signed by a party the client trusts</li>
    </ul>
  </li>
  <li>The server has also sends an asymmetric key continued with the certificate</li>
  <li>The client and server setup symmetric key encryption</li>
  <li>All communication is then encrypted</li>
  <li>The server then verifies the MAC
    <h3 id="public-key">Public Key</h3>
    <p>These are the keys that are used to encrypt data asymmetrically.
They are distributed with a certificate signed by a certificate authority.</p>
    <h3 id="certificate-authority">Certificate authority</h3>
    <p>These are 3rd parties and the public keys are installed with OS/ browser establishing trust and sign certificates to verify identity.</p>
  </li>
</ol>

<p>Signatures can be compared with the public key to ensure identity.</p>

<p>Issuing a certificate is done when a domain registrant can prove they own the domain</p>

<h2 id="drawbacks">drawbacks</h2>
<p>Encryption algorithms can be computationally intensive</p>

<p>Dedicated and faster hardware generally now makes this negligible</p>

<h2 id="man-in-the-middle">Man in the middle</h2>
<p>a machine sits in the middle and read the messages</p>

<p>even if keys are transmitted fake keys can be made can can be decrypted in the middle</p>

<p>By signing certificated fake keys cannot be made</p>

<h1 id="sql-injection">SQL injection</h1>
<p>Transmitting SQL strings to modify the database request</p>

<p>consider the defaut request
<code class="language-plaintext highlighter-rouge">"SELECT * FROM users WHERE name ='"+UserName+"';"</code></p>

<p>by adding ``or ‚Äò1‚Äô=1` to a username entry box
the query becomes</p>

<p><code class="language-plaintext highlighter-rouge">"SELECT * FROM users WHERE name = '' or '1'=1;"</code></p>

<p>this would return all users from the database</p>

<p>Other issues could be destroying databases or modifying entries.</p>

<h2 id="prevention">Prevention</h2>
<p>The use of parameterized statements that has placeholder values where the data can be added later</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$stmt</span><span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="nf">prepare</span><span class="p">(</span><span class="s2">"Select bar FORM foo WHERE id=;id"</span><span class="p">);</span>
<span class="nv">$stmt</span><span class="o">-&gt;</span><span class="nf">bindValue</span><span class="p">(</span><span class="s2">";id"</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="no">SQLITE3_INTEGER</span><span class="p">);</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span> <span class="nf">execute</span><span class="p">();</span>
</code></pre></div></div>
<p>this treats all data as data and never as instructions.</p>

<p>alternatively <code class="language-plaintext highlighter-rouge">addslashes()</code> can be used to escape any characters but is not a preferred method</p>

<p>Other additional ensures can be database access management such as limits on deletion</p>

<h1 id="session-sniffing">Session Sniffing</h1>
<p>An attacker observers communication between a server and a victim , Cookies and session data could be reconstructed which could then be used to impersonate the victim.</p>

<h1 id="session-fixation">Session Fixation</h1>
<p>An attacker obtains a session ID form the server
The attacker then forces the session id of the victim to be identical to theirs
The victim logs on, the attacker can then use their session id</p>

<h1 id="xss">XSS</h1>
<p>Cross Site scripting, Injects client script into webpages</p>

<p>Accounts for 84% of all security Vulnerabilities documents by Symantec in 2007</p>

<p>Non-Persistent data is provided by a client and is used by a server without proper sanitization. The content is uploaded back to the page could be provided by clicking in a link like a GET request</p>

<p>consider</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$name</span> <span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'name'</span><span class="p">];</span>
<span class="k">echo</span> <span class="s2">"Hi </span><span class="nv">$name</span><span class="s2">!"</span><span class="p">;</span>
</code></pre></div></div>
<p>the user gould be given a link with HTTP / javascript as name the javascript would then be run by the browser.</p>

<p>this should be avoided by filtering</p>

<p><code class="language-plaintext highlighter-rouge">$name= filter_input(INPUT_GET,'name',FILTER_SANITIZE_STRING);</code></p>

<p>and output should be escaped</p>

<pre><code class="language-PHP">$name= filter_input(INPUT_GET,'name',FILTER_SANITIZE_STRING);
echo 'Hi '.htmlspecialchars($name,ENT_COMPAT,'UTF-8')
</code></pre>

<p>recommendation is to store the data in as raw form as possible and only convert when it is time to output it.</p>

<h2 id="persistent-xss">Persistent-XSS</h2>
<p>When data is stored to a database then redisplayed later for a user, e.g a comment.</p>

<p>All data should be escaped.</p>

<h1 id="directory-traversal">Directory traversal</h1>

<p>A user many insert a path outside the web</p>

<p>Restrict access to only some directories (whitelisting)</p>

<p>Convert paths to absolute and ensure they are in the correct directory</p>

<h1 id="php-cgi-vulnerabilites">PHP-CGI vulnerabilites</h1>

<p>PHP-CGI  had the option to server the php source</p>

<p>another option allows the setting of variables this could allow variable and variable manipulation this should be disable d in sever settings</p>

<h2 id="other-configuration-advice">other configuration advice</h2>
<p><code class="language-plaintext highlighter-rouge">allow_url_fopen</code> - indicates wether remote files can be downloaded
                    should be off
<code class="language-plaintext highlighter-rouge">allow_url_include</code> - indicated wether scripts can include/ require remote files
turn off if not needed</p>

                
                <footer class="site-footer">
                    
                    <span class="site-footer-owner"><a href="https://github.com/CSRG-Group/dcs-notes.github.io">dcs-notes.github.io</a> is maintained by <a href="https://github.com/CSRG-Group">CSRG-Group</a>.</span>
                    
                    <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub
                            Pages</a>.</span>
                </footer>
            </main>
        </div>
    </div>
</body>

</html>